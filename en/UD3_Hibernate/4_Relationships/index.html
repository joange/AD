
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../3_Entities_Beans/">
      
      
        <link rel="next" href="../5_HQL/">
      
      
      <link rel="icon" href="../../../assets/jaume.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>4. Relationships - Accés a Dades</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-mapping-relations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../" title="Accés a Dades" class="md-header__button md-logo" aria-label="Accés a Dades" data-md-component="logo">
      
  <img src="../../../assets/jaume.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Accés a Dades
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              4. Relationships
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../UD3_Hibernate/4_Relationships/" hreflang="ca" class="md-select__link">
              Valencià
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="Accés a Dades" class="md-nav__button md-logo" aria-label="Accés a Dades" data-md-component="logo">
      
  <img src="../../../assets/jaume.png" alt="logo">

    </a>
    Accés a Dades
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 1. Files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Unit 1. Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/1_File_System/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. File System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/2_Reading_and_writing_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Reading and Writing Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/3_XML_Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Working with XML Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/4_JSON_Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Working with JSON Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/5_Extra_Formats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Other File Formats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 2. Connectors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Unit 2. Connectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/1_Object_relational_impedance_mismatch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Object-relational impedance mismatch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/2_Connectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Connectors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/3_Connecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Connecting to the database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/4_Resultset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Query results
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/5_Metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/6_CRUD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. CRUD Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/7_Row_to_Object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. From rows to objects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 3. Hibernate
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Unit 3. Hibernate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_Mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.Object mapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_Hibernate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Introduction to Hibernate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_Entities_Beans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Entities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    4. Relationships
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    4. Relationships
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-mapping-relations" class="md-nav__link">
    <span class="md-ellipsis">
      1. Mapping Relations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-one-to-one-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      2. One to One Relationships
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. One to One Relationships">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-one-to-one-bidirectional" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. One to One bidirectional
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-one-to-many" class="md-nav__link">
    <span class="md-ellipsis">
      3. One to Many
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. One to Many">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-fetch-type" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Fetch type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-many-to-many" class="md-nav__link">
    <span class="md-ellipsis">
      4. Many to Many
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5_HQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Queries
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 4. OO Databases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Unit 4. OO Databases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/1_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduction to OO Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/2_ORDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Objet-Relational Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/3_OODB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Object-Oriented Databases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 5. Spring
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Unit 5. Spring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/1_Data_Access_Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Data Access Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/2_Spring_SpringBoot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Introduction to Spring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/3_API_Rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Creating API's REST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/4_Spring_Security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/5_Spring_Hateoas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Spring Hateoas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/6_Postman_Swagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Test. Postman and Swagger
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 6. MongoDB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Unit 6. MongoDB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/1_NoSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. NoSQL Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/2_MongoDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Introduction to MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/3_ShellOperations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Shell Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/4_Queries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. CRUD Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/5_Mongo_Java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Mongo and Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/6_Spring_MongoDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Spring MongoDB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practices
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Practices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Practiques/APAC1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practice 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Practiques/APAC2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pràctica 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Practiques/APAC3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pràctica 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About me
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-mapping-relations" class="md-nav__link">
    <span class="md-ellipsis">
      1. Mapping Relations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-one-to-one-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      2. One to One Relationships
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. One to One Relationships">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-one-to-one-bidirectional" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. One to One bidirectional
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-one-to-many" class="md-nav__link">
    <span class="md-ellipsis">
      3. One to Many
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. One to Many">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-fetch-type" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Fetch type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-many-to-many" class="md-nav__link">
    <span class="md-ellipsis">
      4. Many to Many
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>4. Relationships</h1>

<h2 id="1-mapping-relations">1. Mapping Relations</h2>
<p>As we mentioned in the introduction, we are going to analyze how to map the different types of relationships. Before we start discussing the cardinality of relationships, we have to consider the meaning of these relationships, and we are going to review the concept of directionality of relationships.</p>
<ul>
<li><strong>Unidirectional</strong> <span class="arithmatex">\(\rightarrow\)</span> We will say that a relationship is unidirectional when we will access the related object (component) from another object (owner). For example, if we mount an <em>engine</em> in a <em>car</em>, the logical thing is that the owner is the <em>car</em>, and from it, we will obtain the <em>engine</em>. In this case, inside the <em>Car</em> object, an <em>Engine</em> object will appear, and the <em>Engine</em> will not have an existence of its own.</li>
<li><strong>Bi directional</strong> <span class="arithmatex">\(\rightarrow\)</span> They are relations in which the related elements usually have the same <em>weight</em> or entity. For example, a <em>Group</em> of an institute and a <em>Tutor</em>. From a group if it makes sense to know the tutor, and we can also from a teacher (the tutor), access the group he tutors. In this case, within the <em>Group</em> object we have a reference to the <em>Tutor</em> object and vice versa.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In this type of references, as can be deduced, there is an intrinsic recursion. So, when we handle this type of bidirectional relationships, be very careful not to cause loops, since even something as simple as printing can cause our program to crash and the well-known <code>StackOverflowException</code></p>
</div>
<p>From now, we could study all representations with JPA</p>
<h2 id="2-one-to-one-relationships">2. One to One Relationships</h2>
<p>For the explanation of the examples, we will see the design and implementation in the database of each case and how it looks in Hibernate. For this example we are going to represent a 1:1 relationship between Group and Teacher, whereas you can see that a Group has a Tutor, and a Tutor only could tutoring one Group.</p>
<p><center><img alt="one_to_one" src="../../../UD3_Hibernate/img/1_1.png" width="90%" /></center></p>
<p>Firstly, the class that is pointed by the foreign key. Easy-peasy, because we do not need nothing to do.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@Data</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nd">@NoArgsConstructor</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="nd">@Entity</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Profesor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Profesor</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1L</span><span class="p">;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">  </span><span class="nd">@Id</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">  </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">GenerationType</span><span class="p">.</span><span class="na">IDENTITY</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idTeacher</span><span class="p">;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">  </span><span class="nd">@Column</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="nf">Profesor</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">  </span><span class="p">}</span><span class="w">   </span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>And now, the class that contains the foreign key. Here we need to mark that a Group need a Teacher as tutor. Let's see:</p>
<p><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nd">@Data</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="nd">@NoArgsConstructor</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="nd">@Entity</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Grupo&quot;</span><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Grupo</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">137L</span><span class="p">;</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">  </span><span class="nd">@Id</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">  </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerationType</span><span class="p">.</span><span class="na">IDENTITY</span><span class="p">)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">idGroup</span><span class="p">;</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">  </span><span class="nd">@Column</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">level</span><span class="p">;</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">  </span><span class="nd">@Column</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">course</span><span class="p">;</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">  </span><span class="nd">@Column</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="p">;</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="w">  </span><span class="nd">@OneToOne</span><span class="p">(</span><span class="n">cascade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CascadeType</span><span class="p">.</span><span class="na">ALL</span><span class="p">)</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="w">  </span><span class="nd">@JoinColumn</span><span class="p">(</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="w">      </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;id_tutor&quot;</span><span class="p">,</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><span class="w">      </span><span class="n">referencedColumnName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;idTeacher&quot;</span><span class="p">,</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="w">      </span><span class="n">unique</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="w">      </span><span class="n">foreignKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@ForeignKey</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FK_GRP_TEACH&quot;</span><span class="p">))</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="n">Profesor</span><span class="w"> </span><span class="n">tutor</span><span class="p">;</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="nf">Grupo</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">course</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level</span><span class="p">;</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">course</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">course</span><span class="p">;</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">;</span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a><span class="w">  </span><span class="p">}</span><span class="w">  </span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
Notice that Group class contains a field called <code>tutor</code> of <code>Profesor</code> class, and:</p>
<ul>
<li><code>@OneToOne(cascade = CascadeType.ALL)</code> we mark this relation as 1:1. Moreover, we say the <code>cascade</code> attribute, the most important thing. Cascading is the way say that when we perform some action on the target entity (Grupo), the same action will be applied to the associated entity (Profesor). Let's review the most relevant options:</li>
<li><code>CascadeType.ALL</code> propagates all operations. The same operation that we do in the target will be done it in the associated.</li>
<li><code>CascadeType.PERSIST</code> propagates only persist operation on database (save).</li>
<li><code>CascadeType.SAVE_UPDATE</code> is from Hibernate, not JPA, and propagate the <code>saveOrUpdate()</code> method. Is very similar to persist.</li>
<li><code>CascadeType.REMOVE</code> or <code>CascadeType.DELETE</code> propagates deletion of entities. Be very careful with this option to avoid lose data.</li>
<li>In the <code>@JoinColumn</code> we set:</li>
<li>name of the column in our database</li>
<li>name of the column referenced in target entity Profesor</li>
<li><code>unique=true</code> to ensure that the relation is 1:1 (a teacher can not be related with any other Group)</li>
<li>[optional] to set the foreign key constraint name, in case you want to rename or remove in future operations.</li>
</ul>
<p>You can find more info at <a href="https://www.baeldung.com/jpa-cascade-types">baeldung</a></p>
<h3 id="21-one-to-one-bidirectional">2.1. One to One bidirectional</h3>
<p>If we want to store in Profesor the groups that he or she is tutoring, we need to add a reference to the Group. Due to we have done the foreign key in Group, it will be very easy:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nd">@OneToOne</span><span class="p">(</span><span class="n">mappedBy</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tutor&quot;</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="kd">private</span><span class="w"> </span><span class="n">Grupo</span><span class="w"> </span><span class="n">elGrupo</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>With <code>mappedBy="tutor"</code> we are saying that in <code>Grupo</code> class exists a field called <code>tutor</code> with the whole information about the relation. Notice that no extra fields will beb added in Profesor, because information about the relation is in Group table.</p>
<h2 id="3-one-to-many">3. One to Many</h2>
<p>For this explanation we will start from the following model, in which a <strong>Book</strong> has an <strong>Author</strong> who has written it, and an Author may have written several Books. In the relational schema, the relationship is from <code>idAuthor</code> in Books, which is foreign key to the Author table (ID).</p>
<p><center><img alt="one_to_many" src="../../../UD3_Hibernate/img/1_N.png" width="90%" /></center></p>
<p>First, we can decide who is the owner of the relation. It really does not mind, but in several designs it is very clear, for instance between <code>Student</code> and <code>Email</code>, who obviously the owner is <code>Student</code>. Normally should be the class with <strong>many</strong> cardinality the owner. Let's go with the sample.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="nd">@Entity</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Libro&quot;</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Libro</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="nd">@Id</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">GenerationType</span><span class="p">.</span><span class="na">IDENTITY</span><span class="p">)</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">idLibro</span><span class="p">;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">    </span><span class="nd">@Column</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">titol</span><span class="p">;</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">    </span><span class="nd">@Column</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">tipus</span><span class="p">;</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">    </span><span class="nd">@ManyToOne</span><span class="p">(</span><span class="n">cascade</span><span class="o">=</span><span class="n">CascadeType</span><span class="p">.</span><span class="na">PERSIST</span><span class="p">)</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">    </span><span class="nd">@JoinColumn</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;idAutor&quot;</span><span class="p">,</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">                </span><span class="n">foreignKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@ForeignKey</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FK_LIB_AUT&quot;</span><span class="w"> </span><span class="p">))</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Autor</span><span class="w"> </span><span class="n">elAutor</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>In this sample, a <code>Book</code> has an (unique) author. We implement it storing a reference to an Author object, called <code>elAutor</code> inside our Book. We have to write the relation information in this field:</p>
<ul>
<li>We must mark this field as <code>@ManyToOne</code>, because Book is at the many's side of the relation (remember that an Author can write several Books)</li>
<li>The foreign key will be annotated with <code>@JoinColumn</code> label, with several attributes:</li>
<li>Since <code>elAutor</code> is the initial point of the foreign key, who point to the <code>Author</code> table, we need to say the name of the primary key in it class. This attribute is optional, but is a good option to improve our code.</li>
<li>Optional, we can name the constraint of the foreign key, with a well-structured name, with the <code>foreignKey</code> attribute</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nd">@Entity</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Libro&quot;</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Autor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="p">{</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">137L</span><span class="p">;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">    </span><span class="nd">@Id</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">    </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">GenerationType</span><span class="p">.</span><span class="na">IDENTITY</span><span class="p">)</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">idAutor</span><span class="p">;</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">    </span><span class="nd">@Column</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">nom</span><span class="p">;</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">    </span><span class="nd">@Column</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">nacionalitat</span><span class="p">;</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">    </span><span class="nd">@OneToMany</span><span class="p">(</span><span class="n">mappedBy</span><span class="o">=</span><span class="s">&quot;elAutor&quot;</span><span class="p">,</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">            </span><span class="n">cascade</span><span class="o">=</span><span class="n">CascadeType</span><span class="p">.</span><span class="na">PERSIST</span><span class="p">,</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">            </span><span class="n">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FetchType</span><span class="p">.</span><span class="na">LAZY</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Libro</span><span class="o">&gt;</span><span class="w"> </span><span class="n">elsLlibres</span><span class="p">;</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">    </span><span class="c1">// rest of the class</span>
</code></pre></div></td></tr></table></div>
<p><code>Author</code> class is on the <em>one</em> side, and it means that it can write <em>many</em> <code>Books</code>. For this reason we store all the books it has written in a <code>Set</code> of books. The annotations will be:</p>
<ul>
<li>As one Author can write many books, we mark the Set of books as <code>@OneToMany</code>. As we have written the relation specification in Book, we could say that the relation is mapped in <code>elAutor</code> field inside <code>Book</code> class, with <code>mappedBy="elAutor"</code> easily.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Decissió</p>
<p>Instead of storing books in a Set, it can be stored in List. The main difference is to answer this question: <em>is it important the order?</em>. If you respond <em>yes</em>, you must use a List. It the response is <em>no</em> you must use a Set.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Espai</p>
<p>The <code>1:N</code> that we have explained is bidirectional relation. It means that from an Author we can get all the Books he/she has written, and from a Book we can get the Author.</p>
<p><center><img alt="one_to_many_bidirectional" src="../../../UD3_Hibernate/img/1_N_B.png" width="90%" /></center></p>
<p>You could find several pages and books who explain unidirectional <code>1:N</code> relations. It means that with this kind of implementation we only can travel in one direction. In this case we must store only inside a Book who is the author, because Book is the owner. We must remove the Set of books in author to get an unidirectional relation.</p>
</div>
<h3 id="31-fetch-type">3.1. Fetch type</h3>
<p>This attribute usually appears when we have in a <code>1:N</code> or <code>N:M</code> relationship in a class that has a collection of related classes (can also be specified with a <code>1:1</code> but is less common). When Hibernate loads an object, it will load its general attributes (name, nationality, etc...), but what about the Books he has written, loads them or not?</p>
<ul>
<li><code>DateType.EAGER</code> <span class="arithmatex">\(\rightarrow\)</span> Literally translated as <strong>anxious</strong> (ansioso). We can't wait, and when Author is loaded, Hibernate will resolve the relationship and load all the books with all the internal data for each book. We have all the data at the moment.</li>
<li><code>DateType.LAZY</code> <span class="arithmatex">\(\rightarrow\)</span> Literally as <em>lazy</em> (vago), but more representative as <em>lazy loading</em>. If we load the Author, Hibernate only loads the Author's own attributes, without loading its Books. When we try to access their books from our program, Hibernate is <em>activated</em> and loads them. That is, in LAZY mode, the data is loaded <strong>when is needed</strong>.</li>
</ul>
<p><strong>What we will do?</strong>*</p>
<p>Which is better or worse? The answer is not simple, since both have pros and cons:</p>
<ul>
<li>In <code>EAGER</code> only one access is made, while in <code>LAZY</code> two accesses or more. </li>
<li>In the <code>EAGER</code> all data is loaded, even if they are not needed, in the <code>LAZY</code> only what is needed is loaded. </li>
</ul>
<p>The programmer must assess and balance the amount of information required at a given time and the cost of access to the database.</p>
<h2 id="4-many-to-many">4. Many to Many</h2>
<p>In this section we will finish with the last type of relationships that we can find in the E/R model, which are many-to-many relationships. It can appear other relationships with higher cardinalities, such as ternary relationships, but as was studied in the first year, all of them can be modeled with binary transformations.</p>
<p>Within binary relationships, we can find two possibilities: </p>
<ul>
<li>Relationships that simply indicate the relationship (for example, that a character may or may not carry a certain type of weapon in a role-playing game) or </li>
<li>Relationships that, apart from indicating it, add new attributes. For instance, an actor participates in a film in a type of role: main, secondary, etc.</li>
</ul>
<p>In the relational model, both cases ended up being modeled as a new table (with or without the attribute). If we find ourselves in the second case, a new table with the attributes it possesses must be modeled with a class, so the <code>N:M</code> relationship between two tables there will be <code>two one-to-many relationships 1:N and N:1</code> (actor-performance and performance-film) We will focus on the first case, since we are already prepared to solve the second one.</p>
<div class="admonition note">
<p class="admonition-title">Improving</p>
<p>For the second part, this tutorial explains how to do it <a href="https://thorben-janssen.com/hibernate-tip-many-to-many-association-with-additional-attributes/">N_M with attributes</a>. Is very recommmended to implement it a sample.</p>
</div>
<p>We are going to model the typical case of a Teacher who teaches several Modules, which can be taught by several teachers. The scheme looks like below:</p>
<p><center><img alt="many to many" src="../../../UD3_Hibernate/img/N_M.png" width="90%" /></center></p>
<p>As we can see, the typical central table of the <code>N:M</code> relationship remains. As previously mentioned, the Teaching table will not exist in the OO model, since it only serves to relate the elements.</p>
<p>The Module and Teacher classes are as follows (only the part related to the relationship is shown) choosing in this case Teacher as the owner of the relationship:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1">// in Professor, a set of Modulo</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="nd">@ManyToMany</span><span class="p">(</span><span class="n">cascade</span><span class="o">=</span><span class="n">CascadeType</span><span class="p">.</span><span class="na">PERSIST</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">            </span><span class="n">fetch</span><span class="o">=</span><span class="n">FetchType</span><span class="p">.</span><span class="na">LAZY</span><span class="p">)</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="nd">@JoinTable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Docencia&quot;</span><span class="p">,</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">          </span><span class="n">joinColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nd">@JoinColumn</span><span class="p">(</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">            </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;idProfesor&quot;</span><span class="p">,</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">            </span><span class="n">foreignKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@ForeignKey</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FK_DOC_PROF&quot;</span><span class="w"> </span><span class="p">))},</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">          </span><span class="n">inverseJoinColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nd">@JoinColumn</span><span class="p">(</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">            </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;idModulo&quot;</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">            </span><span class="n">foreignKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@ForeignKey</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FK_DOC_MOD&quot;</span><span class="w"> </span><span class="p">))})</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="kd">private</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Modulo</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losModulos</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1">// in Modulo.. a set of Professor</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="nd">@ManyToMany</span><span class="p">(</span><span class="n">cascade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CascadeType</span><span class="p">.</span><span class="na">PERSIST</span><span class="p">,</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">            </span><span class="n">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FetchType</span><span class="p">.</span><span class="na">LAZY</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">            </span><span class="n">mappedBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;losModulos&quot;</span><span class="p">)</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="kd">private</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Profesor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losProfesores</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">();;</span>
</code></pre></div></td></tr></table></div>
<p>This is the most complicated specification, let's go:</p>
<ul>
<li>In both classes the mapping is <code>@ManyToMany</code></li>
<li>In both cases we indicate how we handle the cascade operations (<code>cascade</code>) and the loading of the related objects of the other class (<code>fetch</code>)</li>
<li>In the owner class (<code>Professor</code>) a <code>Set&lt;Module&gt;</code> is mapped with the relationship will start from my current class <code>Professor</code> <span class="arithmatex">\(\rightarrow\)</span> teaching <span class="arithmatex">\(\rightarrow\)</span> <code>Modulo</code> (the base type of the Set)</li>
<li>With <code>@JoinTable</code> It is indicated that the relationship links to a table with <code>Docencia</code> name, where:</li>
<li>It will be linked (<code>joincolumns</code>), and the join is with <code>@JoinColumn</code>:<ul>
<li>Starting from the <code>idProfesor</code> field inside the <code>Docencia</code> table</li>
<li>Finishing on the <code>Profesor</code> primary key,</li>
<li>The FK is named <code>foreignKey = @ForeignKey(name = "FK_DOC_PROF" )</code>.</li>
</ul>
</li>
<li>Pay attention that name inside @JoinTable are names in the table Docencia (existing only on the database).</li>
<li>It is mapped from the <code>Docencia</code> table to the <code>Modulo</code> source entity inversely (from the point to the origin of the arrow):   </li>
<li>This is achieved with <code>inverseJoinColumns</code>:<ul>
<li>linking from the <code>idModule</code> field (<code>@JoinColumn</code>).</li>
<li>We also name the FK.</li>
</ul>
</li>
<li>In the related class (<code>Modulo</code>), which is not the owner, we simply indicate that the owner is <code>Profesor</code>, by means of <code>mappedBy="losModulos"</code>.</li>
</ul>
<p>A sample code will be like this:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">Profesor</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Profesor</span><span class="p">(</span><span class="s">&quot;Mario Benedé&quot;</span><span class="p">);</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="n">Profesor</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Profesor</span><span class="p">(</span><span class="s">&quot;Jose Fernandez&quot;</span><span class="p">);</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="n">Modulo</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Modulo</span><span class="p">(</span><span class="s">&quot;Acceso a Datos&quot;</span><span class="p">);</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="n">Modulo</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Modulo</span><span class="p">(</span><span class="s">&quot;Bases de Datos&quot;</span><span class="p">);</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="n">Modulo</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Modulo</span><span class="p">(</span><span class="s">&quot;Programación&quot;</span><span class="p">);</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="n">Modulo</span><span class="w"> </span><span class="n">m4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Modulo</span><span class="p">(</span><span class="s">&quot;Diseño de Interfaces&quot;</span><span class="p">);</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="c1">// añadimos modulos a p1</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="n">p1</span><span class="p">.</span><span class="na">addModulo</span><span class="p">(</span><span class="n">m3</span><span class="p">);</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="n">p1</span><span class="p">.</span><span class="na">addModulo</span><span class="p">(</span><span class="n">m1</span><span class="p">);</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="c1">// añadimos modulos a p2</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="n">p2</span><span class="p">.</span><span class="na">addModulo</span><span class="p">(</span><span class="n">m2</span><span class="p">);</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="n">p2</span><span class="p">.</span><span class="na">addModulo</span><span class="p">(</span><span class="n">m3</span><span class="p">);</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="n">p2</span><span class="p">.</span><span class="na">addModulo</span><span class="p">(</span><span class="n">m4</span><span class="p">);</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="c1">// guardamos</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">persist</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">persist</span><span class="p">(</span><span class="n">p2</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>and the hibernate output will be something like:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span>
<span class="normal"><a href="#__codelineno-8-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>Hibernate:<span class="w"> </span>drop<span class="w"> </span>table<span class="w"> </span><span class="k">if</span><span class="w"> </span>exists<span class="w"> </span>Modulo
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>Hibernate:<span class="w"> </span>drop<span class="w"> </span>table<span class="w"> </span><span class="k">if</span><span class="w"> </span>exists<span class="w"> </span>Profesor
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>Hibernate:<span class="w"> </span>create<span class="w"> </span>table<span class="w"> </span>Docencia<span class="w"> </span><span class="o">(</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">    </span>idProfesor<span class="w"> </span>bigint<span class="w"> </span>not<span class="w"> </span>null,<span class="w"> </span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">    </span>idModulo<span class="w"> </span>bigint<span class="w"> </span>not<span class="w"> </span>null,<span class="w"> </span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">    </span>primary<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>idProfesor,<span class="w"> </span>idModulo<span class="o">))</span><span class="w"> </span><span class="nv">engine</span><span class="o">=</span>InnoDB
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>Hibernate:<span class="w"> </span>create<span class="w"> </span>table<span class="w"> </span>Modulo<span class="w"> </span><span class="o">(</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">    </span>idModulo<span class="w"> </span>bigint<span class="w"> </span>not<span class="w"> </span>null<span class="w"> </span>auto_increment,<span class="w"> </span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">    </span>nombre<span class="w"> </span>varchar<span class="o">(</span><span class="m">255</span><span class="o">)</span>,<span class="w"> </span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">    </span>primary<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>idModulo<span class="o">))</span><span class="w"> </span><span class="nv">engine</span><span class="o">=</span>InnoDB
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>Hibernate:<span class="w"> </span>create<span class="w"> </span>table<span class="w"> </span>Profesor<span class="w"> </span><span class="o">(</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">    </span>idProfe<span class="w"> </span>bigint<span class="w"> </span>not<span class="w"> </span>null<span class="w"> </span>auto_increment,<span class="w"> </span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">    </span>nomProfe<span class="w"> </span>varchar<span class="o">(</span><span class="m">255</span><span class="o">)</span>,<span class="w"> </span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">    </span>primary<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>idProfe<span class="o">))</span><span class="w"> </span><span class="nv">engine</span><span class="o">=</span>InnoDB
<a id="__codelineno-8-15" name="__codelineno-8-15"></a>Hibernate:<span class="w"> </span>alter<span class="w"> </span>table<span class="w"> </span>Docencia<span class="w"> </span>add<span class="w"> </span>constraint<span class="w"> </span>FK_DOC_MOD<span class="w"> </span>
<a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="w">    </span>foreign<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>idModulo<span class="o">)</span><span class="w"> </span>references<span class="w"> </span>Modulo<span class="w"> </span><span class="o">(</span>idModulo<span class="o">)</span>
<a id="__codelineno-8-17" name="__codelineno-8-17"></a>Hibernate:<span class="w"> </span>alter<span class="w"> </span>table<span class="w"> </span>Docencia<span class="w"> </span>add<span class="w"> </span>constraint<span class="w"> </span>FK_DOC_PROF<span class="w"> </span>
<a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="w">    </span>foreign<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>idProfesor<span class="o">)</span><span class="w"> </span>references<span class="w"> </span>Profesor<span class="w"> </span><span class="o">(</span>idProfe<span class="o">)</span>
<a id="__codelineno-8-19" name="__codelineno-8-19"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Profesor<span class="w"> </span><span class="o">(</span>nomProfe<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?<span class="o">)</span>
<a id="__codelineno-8-20" name="__codelineno-8-20"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Modulo<span class="w"> </span><span class="o">(</span>nombre<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?<span class="o">)</span>
<a id="__codelineno-8-21" name="__codelineno-8-21"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Modulo<span class="w"> </span><span class="o">(</span>nombre<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?<span class="o">)</span>
<a id="__codelineno-8-22" name="__codelineno-8-22"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Profesor<span class="w"> </span><span class="o">(</span>nomProfe<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?<span class="o">)</span>
<a id="__codelineno-8-23" name="__codelineno-8-23"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Modulo<span class="w"> </span><span class="o">(</span>nombre<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?<span class="o">)</span>
<a id="__codelineno-8-24" name="__codelineno-8-24"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Modulo<span class="w"> </span><span class="o">(</span>nombre<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?<span class="o">)</span>
<a id="__codelineno-8-25" name="__codelineno-8-25"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Docencia<span class="w"> </span><span class="o">(</span>idProfesor,<span class="w"> </span>idModulo<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?,<span class="w"> </span>?<span class="o">)</span>
<a id="__codelineno-8-26" name="__codelineno-8-26"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Docencia<span class="w"> </span><span class="o">(</span>idProfesor,<span class="w"> </span>idModulo<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?,<span class="w"> </span>?<span class="o">)</span>
<a id="__codelineno-8-27" name="__codelineno-8-27"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Docencia<span class="w"> </span><span class="o">(</span>idProfesor,<span class="w"> </span>idModulo<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?,<span class="w"> </span>?<span class="o">)</span>
<a id="__codelineno-8-28" name="__codelineno-8-28"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Docencia<span class="w"> </span><span class="o">(</span>idProfesor,<span class="w"> </span>idModulo<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?,<span class="w"> </span>?<span class="o">)</span>
<a id="__codelineno-8-29" name="__codelineno-8-29"></a>Hibernate:<span class="w"> </span>insert<span class="w"> </span>into<span class="w"> </span>Docencia<span class="w"> </span><span class="o">(</span>idProfesor,<span class="w"> </span>idModulo<span class="o">)</span><span class="w"> </span>values<span class="w"> </span><span class="o">(</span>?,<span class="w"> </span>?<span class="o">)</span>
</code></pre></div></td></tr></table></div>
<p>After all the tables were created, Hibernate creates the foreign keys, and then insert the recors. Firstly, Profesor and Modulo, and finally the relation in Docencia table.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>
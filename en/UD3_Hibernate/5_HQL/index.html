
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../4_Relationships/">
      
      
        <link rel="next" href="../../UD4_BDOO/1_Introduction/">
      
      
      <link rel="icon" href="../../../assets/jaume.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>5. Queries - Accés a Dades</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-hibernate-query-language" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../" title="Accés a Dades" class="md-header__button md-logo" aria-label="Accés a Dades" data-md-component="logo">
      
  <img src="../../../assets/jaume.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Accés a Dades
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. Queries
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../UD3_Hibernate/5_HQL/" hreflang="ca" class="md-select__link">
              Valencià
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="Accés a Dades" class="md-nav__button md-logo" aria-label="Accés a Dades" data-md-component="logo">
      
  <img src="../../../assets/jaume.png" alt="logo">

    </a>
    Accés a Dades
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Access
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 1. Files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Unit 1. Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/1_File_System/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. File System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/2_Reading_and_writing_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Reading and Writing Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/3_XML_Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Working with XML Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/4_JSON_Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Working with JSON Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/5_Extra_Formats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Other File Formats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 2. Connectors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Unit 2. Connectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/1_Object_relational_impedance_mismatch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Object-relational impedance mismatch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/2_Connectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Connectors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/3_Connecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Connecting to the database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/4_Resultset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Query results
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/5_Metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/6_CRUD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. CRUD Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/7_Row_to_Object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. From rows to objects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 3. Hibernate
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Unit 3. Hibernate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_Mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.Object mapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_Hibernate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Introduction to Hibernate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_Entities_Beans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Entities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_Relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    5. Queries
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    5. Queries
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-hibernate-query-language" class="md-nav__link">
    <span class="md-ellipsis">
      1. Hibernate Query Language
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-recovering-objects" class="md-nav__link">
    <span class="md-ellipsis">
      2. Recovering objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-queries" class="md-nav__link">
    <span class="md-ellipsis">
      3. Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-getting-simple-objects" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Getting simple objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-getting-composite-objects" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Getting composite objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-parameters-and-namedqueries" class="md-nav__link">
    <span class="md-ellipsis">
      4. Parameters and NamedQueries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Parameters and NamedQueries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-positional-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Positional parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-named-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Named parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-named-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Named queries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-crud" class="md-nav__link">
    <span class="md-ellipsis">
      5. CRUD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. CRUD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-create-insert" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Create (insert)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-update" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-deletion" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Deletion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-appendix-objects-status" class="md-nav__link">
    <span class="md-ellipsis">
      6. Appendix, Objects status
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 4. OO Databases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Unit 4. OO Databases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/1_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduction to OO Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/2_ORDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Objet-Relational Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/3_OODB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Object-Oriented Databases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 5. Spring
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Unit 5. Spring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/1_Data_Access_Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Data Access Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/2_Spring_SpringBoot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Introduction to Spring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/3_API_Rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Creating API's REST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/4_Spring_Security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/5_Spring_Hateoas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Spring Hateoas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/6_Postman_Swagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Test. Postman and Swagger
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unit 6. MongoDB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Unit 6. MongoDB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/1_NoSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. NoSQL databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/2_MongoDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/3_ShellOperations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Working with MongoDB: Basic shell operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/4_Queries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Mongo Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/5_Mongo_Java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MongoDB and Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/6_Spring_MongoDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Spring Data MongoDB y API REST
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-hibernate-query-language" class="md-nav__link">
    <span class="md-ellipsis">
      1. Hibernate Query Language
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-recovering-objects" class="md-nav__link">
    <span class="md-ellipsis">
      2. Recovering objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-queries" class="md-nav__link">
    <span class="md-ellipsis">
      3. Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-getting-simple-objects" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Getting simple objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-getting-composite-objects" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Getting composite objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-parameters-and-namedqueries" class="md-nav__link">
    <span class="md-ellipsis">
      4. Parameters and NamedQueries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Parameters and NamedQueries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-positional-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Positional parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-named-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Named parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-named-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Named queries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-crud" class="md-nav__link">
    <span class="md-ellipsis">
      5. CRUD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. CRUD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-create-insert" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Create (insert)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-update" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-deletion" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Deletion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-appendix-objects-status" class="md-nav__link">
    <span class="md-ellipsis">
      6. Appendix, Objects status
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>5. Queries</h1>

<h2 id="1-hibernate-query-language">1. Hibernate Query Language</h2>
<p>Full documentation can be found here:</p>
<ul>
<li>In <a href="https://docs.jboss.org/hibernate/core/3.6/reference/es-ES/html/queryhql.html">spanish</a></li>
<li>In <a href="https://docs.jboss.org/hibernate/core/4.3/manual/en-US/html/ch16.html">english</a></li>
</ul>
<p>The <strong>HQL</strong> language (Hibernate Query Language) was born with the aim of saving the relational model, since it is a supraset of SQL (extension of SQL that includes SQL). The first consideration is that, by default, its functionality is to retrieve objects from the database, not tables as we did in the SQL language through <code>ResultSet</code>. The queries with HQL will be made from a <strong>Query</strong> interface, which will be the place where we will specify what we want to get. Optionally we can add to the query the necessary parameters for its execution, to avoid hard-coded queries.</p>
<p>Firstly, the query will be prepared. When creating it, we have to take into account two options, with four possible combinations: </p>
<ul>
<li>It will return one result or more than one and,</li>
<li>It will return the result encapsulated in objects or in a composite way. </li>
</ul>
<p>Depending on the answer obtained, in the second step we will choose one of the four options seen below.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="mi">1</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">session</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;HQL statement&quot;</span><span class="p">);</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="mf">2.1</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">resultsObjects</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="mf">2.2</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="w"> </span><span class="o">[]&gt;</span><span class="n">mixedresults</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="mf">2.3</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">result</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="mf">2.4</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">result</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="mf">1.</span><span class="w"> </span><span class="c1">// process information obtained</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>In first option the query returns a collection of objects (several rows, on object in a row).</li>
<li>This option return a collection with a composite of objects and another types: for example a Student a number of topics and number of teachers.</li>
<li>Both last options is when, instead of a collection, the query returns a unique object/composite.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><code>session.createQuery</code> allow to write an HQL query, with or without parameters</li>
<li><code>Query.list()</code> get all the objects (as a List) from the database that satisfy the query.</li>
<li><code>Query.uniqueResult()</code> get a single object from the database.</li>
</ul>
</div>
<p>Before details, here you will find some general ideas:</p>
<ul>
<li>We can remove the <code>Select *</code>, to indicate that we want it all attributes.</li>
<li>There is a medium case sensitivity: HQL reserved words are case-insensitive, but references to objects (their names) are case-sensitive: it does not matter to put <code>From</code> or <code>fROm</code>, but a <code>Student</code> is not the same as a <code>student</code>. It is recommended to write sentences in lower case, in order to distinguish from the classes.</li>
<li>After <code>from</code>, it appears the name of a class(es), not tables.</li>
<li>Assigning aliases is highly recommended. We can use joins in similar way to SQL.</li>
<li>Then the <code>where</code> can appear, with its SQL-like conditions.</li>
<li>Text constants are enclosed in single quotes.</li>
<li>We can query from collections that appear inside the objects (from the teacher's set of students, for instace).</li>
<li>There is no <code>limit</code> operator.</li>
<li><code>order by</code> is used similarly to SQL.</li>
<li><code>group by</code> is allowed, and aggregate functions are: COUNT, AVG, SUM, MIN and MAX. </li>
</ul>
<h2 id="2-recovering-objects">2. Recovering objects</h2>
<p>From now, the samples are based on this schema, that you will find here <a href="../../../UD3_Hibernate/DocenciaConsultas.sql">Docencia</a></p>
<p><center><img alt="Docencia for HQL" src="../../../UD3_Hibernate/img/DocenciaHQL.png" width="90%" /></center></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Now is a good moment to try to do a reverse engineering approach to build your project from database.</p>
</div>
<h2 id="3-queries">3. Queries</h2>
<h3 id="31-getting-simple-objects">3.1. Getting simple objects</h3>
<p>These queries are the ones that we want to retrieve an object or collection of these from the database (one or more rows, in comparison with ResultSet). Each result is a single object from a table in the database. They will be characterized because the Select word may not appear or simply indicate the alias of the class we have. Let's see the examples. </p>
<p>The following example shows all students:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">// complete and polite</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a from Alumno a&quot;</span><span class="p">);</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1">// OR</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="c1">// in a quick way</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;from Alumno&quot;</span><span class="p">);</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="c1">// quickest (without type)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;from Alumno&quot;</span><span class="p">);</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losAlumnos</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">losAlumnos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">        </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>If we want to filter or to search for any student, we need to use <code>where</code> clause, as a normal SQL query. Expressions can be:</p>
<p><center><img alt="Where" src="../../../UD3_Hibernate/img/Where.png" width="90%" /></center></p>
<p>When the <code>where</code> filter only one object, we could store it in a List, ant then access it, but is better to get the object directly, as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a from Alumno a where a.idAlumno=1&quot;</span><span class="p">);</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>notice that we create our query with diamond operator, saying that it will return a student. Then, the query return obvously the student. The alternative is casting the returned object of <code>uniqueResult</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a from Alumno a where a.idAlumno=1&quot;</span><span class="p">);</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Alumno</span><span class="p">)</span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Careful</p>
<p>Be careful when retrieving a unique object and the query returns several.
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a from Student a where a.age=24&quot;</span><span class="p">);</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">Student</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">uniqueResult</span><span class="p">();</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="c1">// org.hibernate.NonUniqueResultException: query did not return a unique result: 2</span>
</code></pre></div></td></tr></table></div></p>
</div>
<p>When we have lots of results, it is still not convenient to recover them all at once, but to access them by 10 by 10 or similar, just like the search pages of Google or Amazon. We can achieve this by launching smaller queries repeatedly, applying to the query:</p>
<ul>
<li><code>Q.setFirstResult(int start)</code> → indicates the first object (row) to return.</li>
<li><code>Q.setMaxResult(int howMany)</code> → indicates how many rows it will return.</li>
</ul>
<p>With an appropriate designed algorithm, we can perform a loop, shifting the start in each iteration, incrementing it by the number of rows retrieved in the previous iteration. It would involve a lot of small queries versus one big one.</p>
<h3 id="32-getting-composite-objects">3.2. Getting composite objects</h3>
<p>If we need to get more (or less) data than an entire object, we must do it in the <code>select</code> part of the clause, but when we get the data we can't store it in an Object. For this reason, and using the polymorphism property of Java, we get the results in a generic array of objects. Therefore, we must be very careful with the type of each cell, as well as the size of said array, since it will be strongly linked to the query itself. Let's look at the following query: <em>Display name and age of students</em>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a.nombre,a.edad from Alumno a&quot;</span><span class="p">);</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Alumno: &quot;</span><span class="p">);</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">objects</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">objects</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">);</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Notice than if you only want to print the information, no extra work is needed, due to (almost) all objects can be cast to String. If you want to use in another way, be very careful to convert to the accurate data type.</p>
<p><strong>Collections</strong></p>
<p>We are going to check the name of the students and how many exams they have taken. That information is in the Exam Set, so we'll need to manipulate that collection:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a.nombre,size(a.examens) from Alumno a&quot;</span><span class="p">);</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">alu</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Alumno: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">alu</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; has done &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">alu</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; exams.&quot;</span><span class="p">);</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>As you can see, we have applied the <code>size()</code> function to the collection to see its size. We can therefore apply:</p>
<ul>
<li><code>size(collection)</code> → retrieve the size of the collection.</li>
<li><code>collection is empty</code> | <code>collection is not empty</code> → to determine if it is empty. It is equivalent to comparing the size with 0</li>
<li>Operators <code>in</code>, <code>all</code> can be combined using the operator <code>elements(collection)</code></li>
</ul>
<p>As an advanced query, you can use <code>exists</code> and <code>not exists</code> in your queries.</p>
<h2 id="4-parameters-and-namedqueries">4. Parameters and NamedQueries</h2>
<p>Normally most queries will need some parameters, usually for object filtering in the where clause. The benefits of parameterizing queries to avoid SQL injection or similar problems were already discussed in previous unit.</p>
<p>The management of parameters is carried out in the same way as with prepared statements (<code>preparedStatements</code>), and can be done through positional or nominal parameters. Let's go to see some examples:</p>
<h3 id="41-positional-parameters">4.1. Positional parameters</h3>
<p>We must add placeholders inside our query, but instead of <code>?</code> we add a number after the question mark. Then we must set the parameter according to the placeholder number we have set before, as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span>
<span class="normal"><a href="#__codelineno-7-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Select a from Alumno a where a.edad=?1&quot;</span><span class="p">);</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="n">q</span><span class="p">.</span><span class="na">setParameter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">);</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losAlumnos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Alumno</span><span class="w"> </span><span class="n">alumno</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">losAlumnos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">alumno</span><span class="p">);</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Notice than The <code>setParameter</code> method is overloaded to set every kind of data type.</p>
</div>
<h3 id="42-named-parameters">4.2. Named parameters</h3>
<p>The positions are fine, but if we can indicate the parameters in a nominal way, it will be a much readable program. The parameters are indicated with <code>:parameterName</code> and will be assigned with method <code>setParameter(parameterName,value)</code>, indicating the name of the parameter (without the colon):</p>
<h3 id="43-named-queries">4.3. Named queries</h3>
<p>We can write queries in our methods as we need them. However, it is a good practice to create the most important queries or that we have forecast that they will be the most used together with the same class, through the mechanism that is presented below. In this section we create and <strong>label</strong> our queries, inside a collection of queries, and then we can call it. Is like we create a queries library. </p>
<p>Outside the class definition, a <code>@NamedQueries</code> collection will be created, which will contain an array (indicated by braces) of <code>@NamedQuery</code> elements, each of them with a <strong>name</strong> and a <strong>query</strong> definition.</p>
<p>To invoke them, instead of creating a <code>Query</code> object, we will create it through a <code>NamedQuery</code>, indicating its name, and assigning parameters, if any.</p>
<p>In Alumno class:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nd">@Entity</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Alumno&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">catalog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DocenciaConsultas&quot;</span><span class="p">)</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="nd">@NamedQueries</span><span class="p">({</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">    </span><span class="nd">@NamedQuery</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Repetidores&quot;</span><span class="p">,</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">            </span><span class="n">query</span><span class="o">=</span><span class="s">&quot;select a from Student a where a.repeater=true &quot;</span><span class="p">),</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">    </span><span class="nd">@NamedQuery</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;AlumnosEntre&quot;</span><span class="p">,</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="w">            </span><span class="n">query</span><span class="o">=</span><span class="s">&quot;select a from Student a where a.age between :min and :max&quot;</span><span class="p">),</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">    </span><span class="nd">@NamedQuery</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;AlumnosDescAge&quot;</span><span class="p">,</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">            </span><span class="n">query</span><span class="o">=</span><span class="s">&quot;select a from Student a order by a.age desc&quot;</span><span class="p">)</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="p">})</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Alumno</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">Serializable</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">13L</span><span class="p">;</span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">  </span><span class="p">...</span>
</code></pre></div></td></tr></table></div>
<p>Whern we want to use it, instead of create a <code>Query</code> we must create a <code>NamedQuery</code>, as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">Query</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createNamedQuery</span><span class="p">(</span><span class="s">&quot;Repetidores&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Alumnos repetidores: &quot;</span><span class="p">);</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Alumno</span><span class="o">&gt;</span><span class="w"> </span><span class="n">losAlumnos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">list</span><span class="p">();</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createNamedQuery</span><span class="p">(</span><span class="s">&quot;AlumnosEntre&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="n">q</span><span class="p">.</span><span class="na">setParameter</span><span class="p">(</span><span class="s">&quot;min&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">);</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="n">q</span><span class="p">.</span><span class="na">setParameter</span><span class="p">(</span><span class="s">&quot;max&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">);</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">laSesion</span><span class="p">.</span><span class="na">createNamedQuery</span><span class="p">(</span><span class="s">&quot;AlumnosDescAge&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Alumnos de mayor a menor: &quot;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<h2 id="5-crud">5. CRUD</h2>
<p>Finally, we are going to analyze the rest of the CRUD operations. It should be noted that these operations can be performed directly on the objects, which is why they are explained as complementary rather than main. </p>
<h3 id="51-create-insert">5.1. Create (insert)</h3>
<p>If we want to insert a new object in the database, is very easy, as we can remember in first sections of this unit.</p>
<p><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">Alumno</span><span class="p">();</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">a</span><span class="p">.</span><span class="na">setApellidos</span><span class="p">(</span><span class="s">&quot;Hamilton&quot;</span><span class="p">);</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="n">a</span><span class="p">.</span><span class="na">setNombre</span><span class="p">(</span><span class="s">&quot;Lewis&quot;</span><span class="p">);</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="n">a</span><span class="p">.</span><span class="na">setEdad</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="n">a</span><span class="p">.</span><span class="na">setRepetidor</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">persist</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
Simply we create a new object, set its values, via setters or all argument's constructor, and finally store in the database with <code>persist</code> method. You can use <code>save</code> or <code>saveOrUpdate</code> indistinctly. You can see some differences between them <a href="https://javatute.com/hibernate/difference-between-save-and-persist-in-hibernate/">here</a>. Both of them fires a <code>insert sql</code> statement.</p>
<p>In the same way that SQL, we could insert into a table with the result of a query, as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">SQL</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">class</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span><span class="w"> </span><span class="n">select_hql</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<h3 id="52-update">5.2. Update</h3>
<p>In order to change the value of one or more object properties, we could load the object from database, change values via getters methods, and the save the changes:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span>
<span class="normal"><a href="#__codelineno-12-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="mi">7L</span><span class="p">);</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="n">a</span><span class="p">.</span><span class="na">setEdad</span><span class="p">(</span><span class="mi">44</span><span class="p">);</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="n">a</span><span class="p">.</span><span class="na">setRepetidor</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>If we want to set a massive update, who affect several records in the database, we could use in the same way to SQL:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;Update from Alumno a set a.edad=a.edad+1 where a.repetidor=true&quot;</span><span class="p">);</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">howMany</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">howMany</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; alumnos actualizados&quot;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<h3 id="53-deletion">5.3. Deletion</h3>
<p>As previous sections, we could delete a single object or a set of records who satisfy a condition. In case of a single object, we need to load it, and then delete it:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">Alumno</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Alumno</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="mi">7L</span><span class="p">);</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="n">laSesion</span><span class="p">.</span><span class="na">delete</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Notice that the object remains in memory or until the end of the method, but when the session is commited, the object will be <code>detached</code>. The <code>detached</code> status means that this object is out of any kind of track. We do not have possibility to save or update again this object.</p>
<p>To do a massive deletion, in the same way that SQL:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">Query</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">laSesion</span><span class="p">.</span><span class="na">createQuery</span><span class="p">(</span><span class="s">&quot;delete from Alumno a where a.repetidor=true&quot;</span><span class="p">);</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">howMany</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">howMany</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; alumnos borrados&quot;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Remember this general tips:</p>
<ul>
<li>These statements may contain parameters (in sentences that contains <code>where</code> clause).</li>
<li>The where is optional, but it will delete or update everything if missing.</li>
<li>These queries are all executed using <code>executeUpdate()</code>, because they change the database status, and it will return an integer with the number of affected rows.</li>
</ul>
</div>
<p>You have to pay attention to the deletions, since depending on how we have defined the relationships (deletions in cascade, leaving orphan rows, etc.) they may or may not occur, and throw <code>java.sql.SQLIntegrityConstraintViolationException</code>.</p>
<p>As a final comment in this section, remember what was said previously: in the manipulation of objects (deletions, modifications, etc.) we have enough tools to do it without HQL queries. These queries are more suitable for processing large volumes of information without uploading said information to our program to have it processed.</p>
<h2 id="6-appendix-objects-status">6. Appendix, Objects status</h2>
<p>As we have said along this unit, objects are loaded and tracked by the session manager. Each object could have a state inside the session, and it is interesting to now all possibilities. In this picture, you can see all different status, and the method to change the object status.</p>
<p><center><img alt="Object Status" src="../../../UD3_Hibernate/img/ObjectStatus.png" width="90%" /></center></p>
<ul>
<li><strong>transient</strong> → The object has identity (exist in memory), but it has not a persistent identity, or primary key.</li>
<li><strong>persistent</strong> → The object has been marked to be saved (persisted), and the memory identity is related to the database identity. When we load an object from the database this is the initial status.</li>
<li><strong>detached</strong> → The object have been persisted recently, but this context is closed, with <code>detach()</code> method. Operations when is detached will not be reflected on the database.</li>
<li><strong>removed</strong> → The object has been marked to be deleted (but is not effected yet). When the session is closed it will be removed effectively, but we can reload it and set into a persistent context.</li>
</ul>
<p>You can get more information <a href="https://www.baeldung.com/hibernate-session-object-states">here</a>.</p>
<!--

http://www.cursohibernate.es/doku.php

-->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>

<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../1_Mapping/">
      
      
        <link rel="next" href="../3_Entities_Beans/">
      
      
      <link rel="icon" href="../../assets/jaume.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>2. Introduccio a Hibernate - Accés a Dades</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-hibernate" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Capçalera">
    <a href="../.." title="Accés a Dades" class="md-header__button md-logo" aria-label="Accés a Dades" data-md-component="logo">
      
  <img src="../../assets/jaume.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Accés a Dades
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2. Introduccio a Hibernate
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Selecciona la llengua">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../en/UD3_Hibernate/2_Hibernate/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="ca" class="md-select__link">
              Valencià
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
        <button type="reset" class="md-search__icon md-icon" title="Neteja" aria-label="Neteja" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicialitzant cerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegació" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Accés a Dades" class="md-nav__button md-logo" aria-label="Accés a Dades" data-md-component="logo">
      
  <img src="../../assets/jaume.png" alt="logo">

    </a>
    Accés a Dades
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accés a Dades - Informació del mòdul
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unitat 1. Fitxers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Unitat 1. Fitxers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/1_File_System/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Sistema de Fitxers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/2_Reading_and_writing_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Llegint i Escrivint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/3_XML_Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Treball amb Arxius XML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/4_JSON_Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Treball amb Arxius JSON
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD1_Files/5_Extra_Formats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Altres formats de Fitxers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unitat 2. Connectors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Unitat 2. Connectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/1_Object_relational_impedance_mismatch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Desfase objecte-relacional
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/2_Connectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Connectors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/3_Connecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Connectant-se a la base de dades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/4_Resultset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Resultats de les consultes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/5_Metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Metadades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/6_CRUD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Operacions CRUD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD2_Connectors/7_Row_to_Object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. De les files als objectes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unitat 3. Hibernate
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Unitat 3. Hibernate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_Mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Mapeig d'objectes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    2. Introduccio a Hibernate
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2. Introduccio a Hibernate
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Taula de continguts">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Taula de continguts
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-hibernate" class="md-nav__link">
    <span class="md-ellipsis">
      1. Hibernate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-configuracio" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configuració
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      3. Dependencies.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-estructura-del-projecte" class="md-nav__link">
    <span class="md-ellipsis">
      4. Estructura del projecte
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Estructura del projecte">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-beans" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Beans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-fitxers-de-mapeig" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Fitxers de mapeig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-altres-fitxers" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Altres fitxers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-configuracio-del-projecte" class="md-nav__link">
    <span class="md-ellipsis">
      5. Configuració del projecte
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Configuració del projecte">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-hibernatecfgxml" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Hibernate.cfg.xml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-carrega-de-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Càrrega de scripts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-carregant-la-configuracio-i-les-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      6. Carregant la configuració i les sessions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_Entities_Beans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Entitats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_Relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Relacions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5_HQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Consultes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unitat 4. Bases de Dades OO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Unitat 4. Bases de Dades OO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/1_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduccio a les bases de dades OO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/2_ORDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Bases de dades Objecte-Relacionals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD4_BDOO/3_OODB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Bases de dades Orientades a Objectes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unitat 5. Spring
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Unitat 5. Spring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/1_Data_Access_Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Serveis d'Acces a Dades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/2_Spring_SpringBoot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Introducció a Spring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/3_API_Rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Creació de APIs REST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/4_Spring_Security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Seguretat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/5_Spring_Hateoas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Spring Haetoas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD5_Spring/6_Postman_Swagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Test. Postman i Swagger
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unitat 6. MongoDB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Unitat 6. MongoDB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/1_NoSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Bases de dades NoSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/2_MongoDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/3_ShellOperations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Treballant amb MongoDB: Operacions bàsiques de shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/4_Queries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Consultese en Mongo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/5_Mongo_Java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. MongoDB i Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UD6_MongoDB/6_Spring_MongoDB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Spring Data MongoDB i API REST
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llicència
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Taula de continguts">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Taula de continguts
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-hibernate" class="md-nav__link">
    <span class="md-ellipsis">
      1. Hibernate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-configuracio" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configuració
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      3. Dependencies.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-estructura-del-projecte" class="md-nav__link">
    <span class="md-ellipsis">
      4. Estructura del projecte
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Estructura del projecte">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-beans" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Beans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-fitxers-de-mapeig" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Fitxers de mapeig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-altres-fitxers" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Altres fitxers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-configuracio-del-projecte" class="md-nav__link">
    <span class="md-ellipsis">
      5. Configuració del projecte
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Configuració del projecte">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-hibernatecfgxml" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Hibernate.cfg.xml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-carrega-de-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Càrrega de scripts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-carregant-la-configuracio-i-les-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      6. Carregant la configuració i les sessions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>2. Introduccio a Hibernate</h1>

<h2 id="1-hibernate">1. Hibernate</h2>
<p><center><img alt="Hibernate" src="../img/Hibernate.png" width="85%" /></center></p>
<p><a href="https://hibernate.org">Hibernate</a> és un framework ORM per a Java, que facilita la correspondència d'atributs entre una base de dades relacional i el model d'objectes de la nostra aplicació mitjançant fitxers XML o anotacions en els beans d'entitat. És un programari lliure distribuït sota la llicència GPL 2.0, per la qual cosa es pot utilitzar en aplicacions comercials.</p>
<p>La funció principal de Hibernate serà oferir a l'programador les eines per detallar el seu model de dades i les relacions entre ells, de manera que sigui l'ORM mateix el que interactuï amb la base de dades, mentre que el desenvolupador es dedica a manipular objectes.</p>
<p>A més, ofereix un llenguatge de consulta, anomenat HQL (Hibernate Query Language), de manera que sigui l'ORM mateix el que tradueixi aquest llenguatge al de cada motor de base de dades, mantenint així la portabilitat a costa d'un lleuger augment en el temps d'execució.</p>
<p><center><img alt="Hibernate" src="../img/Hibernate-arquitecture.png" width="85%" /></center></p>
<p>Quan es creen objectes, aquests són volàtils o temporals (es destruiran quan l'aplicació finalitzi). Quan volem emmagatzemar-los amb Hibernate, són rastrejats amb un mecanisme anomenat <code>Session</code>. També es rastrejen els objectes carregats des de les bases de dades. Si ho desitgem, podem finalitzar el rastreig, eliminant l'objecte quan ja no el necessitem.</p>
<p>A més, es proporciona un llenguatge de consulta, HQL o <strong>Hibernate Query Language</strong>, basat en OQL. La part subjacent de la sessió, com es pot veure, permet l'ús de diverses tecnologies, incloent JDBC per connectar-se al SGBD necessari.</p>
<h2 id="2-configuracio">2. Configuració</h2>
<p>Hibernate, com un bon framework, no necessita una instal·lació, ja que està integrat en el nostre projecte com a llibreries. Podríem optar per instal·lar moltes llibreries <em>jar</em>, però és molt millor utilitzar un gestor de paquets per automatitzar aquesta tasca. El procés de construcció del projecte serà més fàcil al final.</p>
<p>Utilitzarem <strong>Maven</strong> com a gestor de paquets.</p>
<h2 id="3-dependencies">3. Dependencies.</h2>
<p>En els nostres projectes s'utilitzaran dues eines bàsiques: Hibernate i un controlador per connectar-se a la base de dades seleccionada. Òbviament, cal afegir les dependències al gestor de paquets. En Maven, les dependències s'inclouen al fitxer <code>Pom.xml</code>, a la carpeta arrel del nostre projecte. Dins de l'etiqueta <code>&lt;dependencies&gt;</code> cal afegir:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">XML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="cm">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nt">&lt;dependency&gt;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>8.0.27<span class="nt">&lt;/version&gt;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="nt">&lt;/dependency&gt;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="cm">&lt;!-- https://mvnrepository.com/artifact/org.hibernate/hibernate-core --&gt;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="nt">&lt;dependency&gt;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>org.hibernate<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>hibernate-core<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>5.6.3.Final<span class="nt">&lt;/version&gt;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></td></tr></table></div>
<p>Si has triat Gradle com a gestor de paquets, el teu <code>build.gradle</code> hauria de ser el següent:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>dependencies<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span>//<span class="w"> </span>https://mvnrepository.com/artifact/mysql/mysql-connector-java
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span>implementation<span class="w"> </span>group:<span class="w"> </span><span class="s1">&#39;mysql&#39;</span>,<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;mysql-connector-java&#39;</span>,<span class="w"> </span>version:<span class="w"> </span><span class="s1">&#39;8.0.27&#39;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span>//<span class="w"> </span>https://mvnrepository.com/artifact/org.hibernate/hibernate-core
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span>implementation<span class="w"> </span>group:<span class="w"> </span><span class="s1">&#39;org.hibernate&#39;</span>,<span class="w"> </span>name:<span class="w"> </span><span class="s1">&#39;hibernate-core&#39;</span>,<span class="w"> </span>version:<span class="w"> </span><span class="s1">&#39;5.6.3.Final&#39;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Recorda...</p>
<p>Recorda que pots trobar els paquets a <a href="https://mvnrepository.com/repos/central">https://mvnrepository.com/repos/central</a></p>
</div>
<h2 id="4-estructura-del-projecte">4. Estructura del projecte</h2>
<p>Un cop hem afegit les dependències, hem de crear una estructura de projecte per organitzar les nostres classes, amb l'objectiu de separar la lògica del programa. A continuació, mostrarem una breu descripció, aprofundint en cada punt més endavant.</p>
<h3 id="41-beans">4.1. Beans</h3>
<p>Els Beans són l'evolució dels POJOs que hem estudiat en unitats anteriors. Recorda que aquestes classes són objectes comuns, sense pertànyer a cap arbre d'herència i sense implementar cap interfície. S'utilitzen per emmagatzemar informació sobre un concepte concret (si necessito un cotxe...crea un cotxe).</p>
<p>Com a extensió dels POJOs, apareixen els <strong>Beans</strong>, sense restriccions en els atributs, constructors i herència. Tenen algunes restriccions:</p>
<ul>
<li>Els seus atributs han de ser <code>private</code> (encapsulació).</li>
<li>Han de implementar la interfície <code>Serializable</code>.</li>
<li>Han de tenir getters i setters públics.</li>
<li>Han de tenir un constructor genèric (sense arguments).</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Recorda</p>
<p>La serialització en temps d'execució associa a cada classe serialitzable un número de versió, anomenat <code>serialVersionUID</code>, que s'utilitza durant la deserialització per verificar que l'emissor i el receptor d'un objecte serialitzat han carregat classes per a aquest objecte que són compatibles en relació a la serialització.</p>
<p>Si el receptor ha carregat una classe per a l'objecte que té un <code>serialVersionUID</code> diferent del de la classe de l'emissor corresponent, llavors la deserialització donarà lloc a una <code>InvalidClassException</code>. Una classe serialitzable pot declarar el seu propi <code>serialVersionUID</code> explícitament mitjançant la declaració d'un camp anomenat <code>serialVersionUID</code> que ha de ser estàtic, final i de tipus long:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">137L</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Així, els Beans són components d'accés a dades i representen entitats a la nostra aplicació. És una bona idea crear els nostres Beans a la mateixa carpeta, normalment anomenada <code>Model</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Recorda</p>
<p>Recordes la llibreria <code>Lombok</code>? És molt útil per crear els nostres beans amb només unes poques línies de codi.</p>
</div>
<h3 id="42-fitxers-de-mapeig">4.2. Fitxers de mapeig</h3>
<p>Un cop s'hagin creat les entitats, cal mapejar cada entitat. Cada mapeig estableix les referències entre els beans i les taules, els atributs i les columnes, per establir una coincidència perfecta entre ells.</p>
<p>La primera opció serà crear fitxers de mapeig, amb la sintaxi (en XML) entre les classes i les taules. Si el bean es diu <code>Car</code>, el fitxer de mapeig hauria de ser <code>Car.hbm.xml</code>:</p>
<ul>
<li><code>hbm</code> és per a mapeig d'hibernate</li>
<li><code>xml</code> perquè la sintaxi està en l'especificació XML.</li>
</ul>
<p>Estudiarem els fitxers de mapeig en les següents seccions.</p>
<h3 id="43-altres-fitxers">4.3. Altres fitxers</h3>
<p>Finalment, tindrem la resta de classes del programa, així com l'aplicació o classe principal. Si esteu dissenyant una aplicació amb un entorn gràfic, hi hauria classes de representació de dades o vistes. De manera similar, en cas d'una aplicació web, faltarien els controladors i els serveis.</p>
<h2 id="5-configuracio-del-projecte">5. Configuració del projecte</h2>
<p>Anem a examinar més detingudament el fitxer de configuració d'Hibernate. En el fitxer de configuració d'Hibernate podem establir les opcions de manera desordenada, però es recomana agrupar els blocs d'opcions per aclarir i mantenir el codi, així com indicar mitjançant comentaris què estem fent en cada moment. Ho veurem amb un exemple complet, que detallarem pas a pas en les seccions següents.</p>
<h3 id="51-hibernatecfgxml">5.1. Hibernate.cfg.xml</h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">XML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span>
<span class="normal"><a href="#__codelineno-3-36">36</a></span>
<span class="normal"><a href="#__codelineno-3-37">37</a></span>
<span class="normal"><a href="#__codelineno-3-38">38</a></span>
<span class="normal"><a href="#__codelineno-3-39">39</a></span>
<span class="normal"><a href="#__codelineno-3-40">40</a></span>
<span class="normal"><a href="#__codelineno-3-41">41</a></span>
<span class="normal"><a href="#__codelineno-3-42">42</a></span>
<span class="normal"><a href="#__codelineno-3-43">43</a></span>
<span class="normal"><a href="#__codelineno-3-44">44</a></span>
<span class="normal"><a href="#__codelineno-3-45">45</a></span>
<span class="normal"><a href="#__codelineno-3-46">46</a></span>
<span class="normal"><a href="#__codelineno-3-47">47</a></span>
<span class="normal"><a href="#__codelineno-3-48">48</a></span>
<span class="normal"><a href="#__codelineno-3-49">49</a></span>
<span class="normal"><a href="#__codelineno-3-50">50</a></span>
<span class="normal"><a href="#__codelineno-3-51">51</a></span>
<span class="normal"><a href="#__codelineno-3-52">52</a></span>
<span class="normal"><a href="#__codelineno-3-53">53</a></span>
<span class="normal"><a href="#__codelineno-3-54">54</a></span>
<span class="normal"><a href="#__codelineno-3-55">55</a></span>
<span class="normal"><a href="#__codelineno-3-56">56</a></span>
<span class="normal"><a href="#__codelineno-3-57">57</a></span>
<span class="normal"><a href="#__codelineno-3-58">58</a></span>
<span class="normal"><a href="#__codelineno-3-59">59</a></span>
<span class="normal"><a href="#__codelineno-3-60">60</a></span>
<span class="normal"><a href="#__codelineno-3-61">61</a></span>
<span class="normal"><a href="#__codelineno-3-62">62</a></span>
<span class="normal"><a href="#__codelineno-3-63">63</a></span>
<span class="normal"><a href="#__codelineno-3-64">64</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="cp">&lt;!DOCTYPE hibernate-configuration PUBLIC </span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="cp">    &quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot; </span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="cp">    &quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;&gt;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w"> </span><span class="nt">&lt;hibernate-configuration&gt;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">    </span><span class="nt">&lt;session-factory&gt;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">      </span><span class="cm">&lt;!-- Connection properties --&gt;</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">      </span><span class="cm">&lt;!-- Driver JDBC --&gt;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;connection.driver_class&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">          </span>com.mysql.cj.jdbc.Driver
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">        </span><span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">      </span><span class="cm">&lt;!-- Add ?createDatabaseIfNotExist=true to create database  --&gt;</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;connection.url&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">        </span>jdbc:mysql://localhost:3308/DBName
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">      </span><span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">      </span><span class="cm">&lt;!--user and pass --&gt;</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;connection.username&quot;</span><span class="nt">&gt;</span>root<span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;connection.password&quot;</span><span class="nt">&gt;</span>root<span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">      </span><span class="cm">&lt;!-- extra conf --&gt;</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">      </span><span class="cm">&lt;!-- JDBC connection pool for concurrent connections --&gt;</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;connection.pool_size&quot;</span><span class="nt">&gt;</span>5<span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="w">      </span><span class="cm">&lt;!--  dialect connector. Useful for Foreing Keys--&gt;</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dialect&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a><span class="w">        </span>org.hibernate.dialect.MySQL5InnoDBDialect
<a id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="w">      </span><span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a><span class="w">      </span><span class="cm">&lt;!-- one thread one session --&gt;</span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;current_session_context_class&quot;</span><span class="nt">&gt;</span>thread<span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="w">      </span><span class="cm">&lt;!-- show &quot;reals&quot; SQL ops. only for development--&gt;</span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;show_sql&quot;</span><span class="nt">&gt;</span>true<span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-38" name="__codelineno-3-38"></a>
<a id="__codelineno-3-39" name="__codelineno-3-39"></a><span class="w">      </span><span class="cm">&lt;!-- DB maintenance --&gt;</span>
<a id="__codelineno-3-40" name="__codelineno-3-40"></a><span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;hbm2ddl.auto&quot;</span><span class="nt">&gt;</span>update<span class="nt">&lt;/property&gt;</span>
<a id="__codelineno-3-41" name="__codelineno-3-41"></a>
<a id="__codelineno-3-42" name="__codelineno-3-42"></a><span class="w">      </span><span class="cm">&lt;!-- options hbm2dll:</span>
<a id="__codelineno-3-43" name="__codelineno-3-43"></a><span class="cm">        create : </span>
<a id="__codelineno-3-44" name="__codelineno-3-44"></a><span class="cm">          create always DB when session factory is loaded. Data will be lost.</span>
<a id="__codelineno-3-45" name="__codelineno-3-45"></a><span class="cm">        update : </span>
<a id="__codelineno-3-46" name="__codelineno-3-46"></a><span class="cm">          Data will be safe, but database structure will be update. </span>
<a id="__codelineno-3-47" name="__codelineno-3-47"></a><span class="cm">          Useful in production.</span>
<a id="__codelineno-3-48" name="__codelineno-3-48"></a><span class="cm">        create-drop : </span>
<a id="__codelineno-3-49" name="__codelineno-3-49"></a><span class="cm">          like create and dropping the database.</span>
<a id="__codelineno-3-50" name="__codelineno-3-50"></a><span class="cm">        validate:   </span>
<a id="__codelineno-3-51" name="__codelineno-3-51"></a><span class="cm">          check the mapping between database and beans.</span>
<a id="__codelineno-3-52" name="__codelineno-3-52"></a><span class="cm">      --&gt;</span>
<a id="__codelineno-3-53" name="__codelineno-3-53"></a>
<a id="__codelineno-3-54" name="__codelineno-3-54"></a><span class="w">      </span><span class="cm">&lt;!-- Mapping files. Can be combined--&gt;</span>
<a id="__codelineno-3-55" name="__codelineno-3-55"></a>
<a id="__codelineno-3-56" name="__codelineno-3-56"></a><span class="w">      </span><span class="cm">&lt;!-- mapping classes --&gt;</span>
<a id="__codelineno-3-57" name="__codelineno-3-57"></a><span class="w">      </span><span class="nt">&lt;mapping</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;package.class1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-58" name="__codelineno-3-58"></a><span class="w">      </span><span class="nt">&lt;mapping</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;package.class2&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-59" name="__codelineno-3-59"></a>
<a id="__codelineno-3-60" name="__codelineno-3-60"></a><span class="w">      </span><span class="cm">&lt;!-- Maping files--&gt;</span>
<a id="__codelineno-3-61" name="__codelineno-3-61"></a><span class="w">      </span><span class="nt">&lt;mapping</span><span class="w"> </span><span class="na">resource=</span><span class="s">&quot;class3.hbm.xml&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-62" name="__codelineno-3-62"></a><span class="w">      </span><span class="nt">&lt;mapping</span><span class="w"> </span><span class="na">resource=</span><span class="s">&quot;class4.hbm.xml&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-63" name="__codelineno-3-63"></a><span class="w">    </span><span class="nt">&lt;/session-factory&gt;</span>
<a id="__codelineno-3-64" name="__codelineno-3-64"></a><span class="nt">&lt;/hibernate-configuration&gt;</span>
</code></pre></div></td></tr></table></div>
<p>Cal tenir en compte que:</p>
<ul>
<li>És molt recomanable tenir l'opció de mostrar les consultes SQL establerta a <code>true</code>, almenys en els primers projectes, per veure com es realitza la correspondència dels objectes amb les consultes SQL.</li>
<li>L'opció <code>hbm2ddl</code> és molt potent, ja que si només partim del model orientat a objectes, Hibernate crearà la base de dades per a nosaltres (obviament buida de dades). Més endavant veurem en una pràctica posterior una altra opció molt interessant, <code>hbm2java</code>, que mitjançant l'enginyeria inversa ens permetrà crear els nostres Beans a partir del disseny relacional.</li>
<li>Els fitxers de mapeig XML (<mapping resource="class2.hbm.xml">) han d'estar junts amb les classes Java, en el mateix paquet.</li>
<li>Els mapejos dins de les classes (<mapping class="class2.java">) fan referència als propis Beans, com veurem a la següent secció.</li>
</ul>
<h3 id="52-carrega-de-scripts">5.2. Càrrega de scripts</h3>
<p>Si voleu inserir dades a la vostra base de dades en aplicacions de prova, és una bona idea tenir un script SQL i carregar-lo automàticament quan es carregui la configuració d'Hibernate. Podeu afegir un fitxer sota <code>src/main/resources</code> anomenat <code>import.sql</code>, i, després de la creació de taules, si existeix, aquest script s'executarà. Aquesta és la manera de començar un projecte amb dades de prova existents a les nostres bases de dades.</p>
<p>A més, si voleu executar més scripts, podeu afegir fitxers específics a <code>hibernate.cfg.xml</code>, de la següent manera:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">XML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;hibernate.hbm2ddl.import_files&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span>/import1.sql,<span class="w"> </span>/import2.sql
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="nt">&lt;/property&gt;</span>
</code></pre></div></td></tr></table></div>
<h2 id="6-carregant-la-configuracio-i-les-sessions">6. Carregant la configuració i les sessions</h2>
<p>Per tal de carregar el fitxer de configuració anterior, hem de crear un objecte <code>SessionFactory</code> a través del qual podem crear instàncies de <code>Session</code> per connectar-nos a la nostra base de dades. L'estructura d'aquesta classe serà sempre la mateixa: carregar el fitxer de configuració XML i després crear la <code>SessionFactory</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">HibernateUtil</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">SessionFactory</span><span class="w"> </span><span class="n">sessionFactory</span><span class="p">;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">    </span><span class="c1">// Código estático. Sólo se ejecuta una vez, como un Singleton</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">            </span><span class="c1">// Creamos es SessionFactory desde el fichero hibernate.cfg.xml </span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">            </span><span class="n">sessionFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Configuration</span><span class="p">()</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">                </span><span class="p">.</span><span class="na">configure</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">&quot;hibernate.cfg.xml&quot;</span><span class="p">)).</span><span class="na">buildSessionFactory</span><span class="p">();</span><span class="w">    </span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error en la inicialización.  &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ExceptionInInitializerError</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">SessionFactory</span><span class="w"> </span><span class="nf">getSessionFactory</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sessionFactory</span><span class="p">;</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Atenció</p>
<p>Aquesta implementació s'ha realitzat amb el patró de disseny <em>Singleton</em>, per tal de tenir una única instància de SessionFactory.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiat al porta-retalls", "clipboard.copy": "C\u00f2pia al porta-retalls", "search.result.more.one": "1 m\u00e9s en aquesta p\u00e0gina", "search.result.more.other": "# m\u00e9s en aquesta p\u00e0gina", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.term.missing": "Desaparegut", "select.version": "Selecciona la versi\u00f3"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>